<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Details</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #007bff;
            color: #fff;
            padding: 20px;
        }
    </style>
</head>
<body>
<header>
    <span th:if="${#authorization.expression('isAuthenticated()')}">
         <span>Welcome <span th:text="${#authentication.name}"></span></span>
    </span>
</header>

<div id="userDetails">
<!--    <p>Username: <span th:text="${user.username}"></span></p>-->
<!--    <p>Email: <span th:text="${userDetails.email}"></span></p>-->
<!--    <p>Phone Number: <span th:text="${user.phoneNumber}"></span></p>-->
</div>

<script th:inline="javascript">
    function loadUserDetails() {
        // Make an AJAX request to fetch user details
        var xhr = new XMLHttpRequest();
        xhr.open('GET', '/userinfo', true);
        xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 300) {
                // Request was successful, update the user details
                document.getElementById('userDetails').innerHTML = xhr.responseText;
            } else {
                // Request failed, handle error
                console.error('Failed to load user details');
            }
        };
        xhr.onerror = function () {
            // Network error
            console.error('Network error occurred');
        };
        xhr.send();
    }

    // Call loadUserDetails function when the page loads
    window.onload = loadUserDetails;
</script>

</body>
</html>
